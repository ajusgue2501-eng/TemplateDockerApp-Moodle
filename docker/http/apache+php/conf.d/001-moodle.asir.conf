# Define un VirtualHost que escuchara en el puerto indicado para Moodle
<VirtualHost *:${MOODLE_SERVER_PORT}>

    # Nombre del servidor Moodle
    ServerName ${MOODLE_SERVER_NAME}

    # Correo del administrador del servidor
    ServerAdmin you@${MOODLE_SERVER_NAME}

    # Carpeta raiz de documentos de Moodle
    DocumentRoot "${MOODLE_FOLDER_NAME}"

    # Configuracion de acceso a la carpeta raiz de Moodle
    <Directory "${MOODLE_FOLDER_NAME}">
        # Permite listar directorios y seguir enlaces simbolicos
        Options Indexes FollowSymLinks
        # Permite que se usen archivos .htaccess
        AllowOverride All
        # Permite acceso a todos los usuarios
        Require all granted
    </Directory>

    # Configuracion para que los archivos .php se procesen con PHP
    <FilesMatch \.php$>
        SetHandler application/x-httpd-php
    </FilesMatch>

    # Archivos por defecto que se serviran
    DirectoryIndex index.php index.html info.php

    # Archivo de log de errores especifico para Moodle
    ErrorLog /var/log/apache2/error_${MOODLE_SERVER_NAME}.log 

    # Archivo de log de accesos especifico para Moodle
    CustomLog /var/log/apache2/access_${MOODLE_SERVER_NAME}.log combined

</VirtualHost>
